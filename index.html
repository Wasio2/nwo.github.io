<!DOCTYPE html>
<html>
<head>
  <title>Legal Marketplace</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>Find Online Lawyers</h1>
    <ul id="lawyer-list">
      <!-- Initial loading message -->
      <li>Loading online lawyers...</li>
    </ul>
  </div>

  <script>
    const BACKEND_URL = "https://nwo-backend-production.up.railway.app";

    async function fetchLawyers( ) {
      try {
        const res = await fetch(`${BACKEND_URL}/api/lawyer/list`);
        
        if (!res.ok) {
          throw new Error(`HTTP error! Status: ${res.status}`);
        }

        const lawyers = await res.json();
        const listEl = document.getElementById("lawyer-list");
        listEl.innerHTML = "";

        if (lawyers.length === 0) {
          listEl.innerHTML = "<li>No lawyers are currently online.</li>";
          return;
        }

        lawyers.forEach(l => {
          const li = document.createElement("li");
          // Use classes for styling
          li.innerHTML = `<span class="lawyer-name">${l.name}</span> <span class="lawyer-rating">Rating: ${l.rating}</span>`;
          listEl.appendChild(li);
        });
      } catch (error) {
        console.error("Error fetching lawyers:", error);
        const listEl = document.getElementById("lawyer-list");
        listEl.innerHTML = `<li>Error connecting to backend: ${error.message}</li>`;
      }
    }

    fetchLawyers();
    setInterval(fetchLawyers, 10000); // refresh every 10s
  </script>
</body>
</html>
